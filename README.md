# Stockpilot

Stockpilot ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∞—Å–∞–º–∏ –∏ –∑–∞–∫–∞–∑–∞–º–∏, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ Go. –ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (Clean Architecture).

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:

### `cmd/`
–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
- **`cmd/api`**: –°–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª `main.go`. –û—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞ –≤—ã–∑–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### `internal/`
–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –¥–æ–º–µ–Ω, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞).
- **`app`**: –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–±–æ—Ä–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (DI), –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–ª–æ–≥–≥–µ—Ä, —Ç—Ä–µ–π—Å–∏–Ω–≥, –ë–î) –∏ –∑–∞–ø—É—Å–∫ HTTP-—Å–µ—Ä–≤–µ—Ä–∞. –†–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Graceful Shutdown.
- **`config`**: –°–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Ç–µ–≥–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ YAML/JSON —Ñ–∞–π–ª–æ–≤ –∏ —Ñ–ª–∞–≥–æ–≤ –∑–∞–ø—É—Å–∫–∞.
- **`domain`**: –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –°–æ–¥–µ—Ä–∂–∏—Ç:
  - –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (`User`, `Product`, `Order`).
  - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–ø–æ—Ä—Ç—ã) –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞.
  - –≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥—Ä—É–≥–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤.
- **`service`**: –°–ª–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏. –†–µ–∞–ª–∏–∑—É–µ—Ç Use Cases (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–∫–∞).
- **`handler`**: –°–ª–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ (HTTP). –°–æ–¥–µ—Ä–∂–∏—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (Handlers) –¥–ª—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ Echo, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ (DTO –¥–ª—è API) –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- **`repository`**: –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.
  - **`repository/postgres`**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–ª—è PostgreSQL.
  - **`repository/dto`**: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏.
- **`middleware`**: –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û –¥–ª—è HTTP-—Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤).

### `pkg/`
–û–±—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö (Infrastructure Layer).
- **`flagparser`**: –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–Ω—Ñ–∏–≥–∞.
- **`gonerve`**: –ù–∞–±–æ—Ä –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –æ–±–µ—Ä—Ç–æ–∫ –∏ —É—Ç–∏–ª–∏—Ç:
  - **`db` / `postgresql`**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –ø—É–ª–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.
  - **`errors`**: –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ –æ—à–∏–±–∫–∞–º–∏.
  - **`genuuid`**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è UUID.
  - **`logging`**: –û–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º –ª–æ–≥–≥–µ—Ä–æ–º (Zap).
  - **`sentry`**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Sentry –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫.
  - **`tracing`**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenTelemetry (Tracing).

### `migrations/`
SQL-—Ñ–∞–π–ª—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

### `docs/`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger/OpenAPI).

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (`code/tests` –∏ `e2e`)
–ü–∞–∫–µ—Ç—ã –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞.
- **`code/tests`**: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
  - –°–æ–¥–µ—Ä–∂–∏—Ç `MemoryRepository` (in-memory —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ç–µ—Å—Ç–æ–≤).
  - –•–µ–ª–ø–µ—Ä—ã –¥–ª—è API-–∫–ª–∏–µ–Ω—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫.
  - –¢–µ—Å—Ç—ã –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å (`concurrency`).
  - –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã (`mainspec`).
- **`e2e`**: End-to-End —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å–∫–∞—é—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–º –∫ –±–æ–µ–≤–æ–º—É (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ –∏ –ø–æ—Ä—Ç–æ–≤).

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

*   **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö (–≤–æ–∑—Ä–∞—Å—Ç, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è).
*   **–ü—Ä–æ–¥—É–∫—Ç—ã**: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω–æ–π –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º.
*   **–ó–∞–∫–∞–∑—ã**: –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ —Å –∞—Ç–æ–º–∞—Ä–Ω—ã–º —Å–ø–∏—Å–∞–Ω–∏–µ–º –æ—Å—Ç–∞—Ç–∫–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤.
*   **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–∫—É–ø–∫—É –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Ç–æ–≤–∞—Ä–∞ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `SELECT ... FOR UPDATE`).
*   **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç—Ä–µ–π—Å–∏–Ω–≥ (OpenTelemetry), –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Zap) –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Sentry.
*   

##üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger)
*–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
*üëâ http://localhost:8080/swagger/index.html
*–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
*–û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
*POST /api/v1/users/register ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
*POST /api/v1/products ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞.
*GET /api/v1/products/{id} ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞.
*POST /api/v1/orders ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **–Ø–∑—ã–∫**: Go 1.23+
*   **–í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫**: Echo v4
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL (pgx v5)
*   **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: Swagger (Swaggo)
*   **–¢–µ—Å—Ç—ã**: Ginkgo / Gomega
*   **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: Docker, Docker Compose

---

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

### 1. –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤ Docker (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–º–µ—Å—Ç–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–æ–º —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏.

```bash
make up